import te from"react";import{addons as W,types as oe}from"@storybook/addons";import x from"react";import{useGlobalTypes as Z}from"@storybook/api";import{Separator as ee}from"@storybook/components";import P,{useCallback as H}from"react";import{useGlobals as J}from"@storybook/api";import{WithTooltip as Q,TooltipLinkList as X}from"@storybook/components";import A from"react";import{Icons as B,IconButton as R}from"@storybook/components";var S=({active:o,title:t,icon:e,description:r,onClick:s})=>A.createElement(R,{active:o,title:r,onClick:s},e&&A.createElement(B,{icon:e}),t?`\xA0${t}`:null);import $,{useRef as j,useEffect as N,useCallback as h}from"react";import{useGlobals as E,useStorybookApi as U}from"@storybook/api";var z=["reset"],k=o=>o.filter(e=>!z.includes(e.type)).map(e=>e.value);var b="addon-toolbars";var M=async(o,t,e)=>{e&&e.next&&await o.setAddonShortcut(b,{label:e.next.label,defaultShortcut:e.next.keys,actionName:`${t}:next`,action:e.next.action}),e&&e.previous&&await o.setAddonShortcut(b,{label:e.previous.label,defaultShortcut:e.previous.keys,actionName:`${t}:previous`,action:e.previous.action}),e&&e.reset&&await o.setAddonShortcut(b,{label:e.reset.label,defaultShortcut:e.reset.keys,actionName:`${t}:reset`,action:e.reset.action})};var w=o=>e=>{let{id:r,toolbar:{items:s,shortcuts:p}}=e,d=U(),[I,a]=E(),i=j([]),n=I[r],u=h(()=>{a({[r]:""})},[a]),C=h(()=>{let l=i.current,y=l.indexOf(n),v=y===l.length-1?0:y+1,m=i.current[v];a({[r]:m})},[i,n,a]),f=h(()=>{let l=i.current,y=l.indexOf(n),T=y>-1?y:0,m=T===0?l.length-1:T-1,g=i.current[m];a({[r]:g})},[i,n,a]);return N(()=>{p&&M(d,r,{next:{...p.next,action:C},previous:{...p.previous,action:f},reset:{...p.reset,action:u}})},[d,r,p,C,f,u]),N(()=>{i.current=k(s)},[]),$.createElement(o,{cycleValues:i.current,...e})};var L=({currentValue:o,items:t})=>o!=null&&t.find(r=>r.value===o),D=({currentValue:o,items:t})=>{let e=L({currentValue:o,items:t});if(e)return e.icon},O=({currentValue:o,items:t})=>{let e=L({currentValue:o,items:t});if(e)return e.title};import _ from"react";import{Icons as q}from"@storybook/components";var G=({left:o,right:t,title:e,value:r,icon:s,hideIcon:p,onClick:d,currentValue:I})=>{let a=s&&_.createElement(q,{style:{opacity:1},icon:s}),i=o||t||e,n={id:r||I,active:I===r,onClick:d};return o&&(n.left=o),t&&(n.right=t),e&&(n.title=e),s&&!p&&(i&&!t?n.right=a:i&&!o?n.left=a:i||(n.right=a)),n};var V=w(({id:o,name:t,description:e,toolbar:{icon:r,items:s,title:p,showName:d,preventDynamicIcon:I,dynamicTitle:a}})=>{let[i,n]=J(),u=i[o],C=!!u,f=r,l=p;I||(f=D({currentValue:u,items:s})||f),d&&!l?(l=t,console.warn("`showName` is deprecated as `name` will stop having dual purposes in the future. Please specify a `title` in `globalTypes` instead.")):!d&&!f&&!l&&(l=t,console.warn(`Using the \`name\` "${t}" as toolbar title for backward compatibility. \`name\` will stop having dual purposes in the future. Please specify either a \`title\` or an \`icon\` in \`globalTypes\` instead.`)),a&&(l=O({currentValue:u,items:s})||l);let y=H(T=>{n({[o]:T})},[u,n]);return P.createElement(Q,{placement:"top",trigger:"click",tooltip:({onHide:T})=>{let v=s.filter(({type:m})=>{let g=!0;return m==="reset"&&!u&&(g=!1),g}).map(m=>G({...m,currentValue:u,onClick:()=>{y(m.value),T()}}));return P.createElement(X,{links:v})},closeOnClick:!0},P.createElement(S,{active:C,description:e||"",icon:f,title:l||""}))});var Y={type:"item",value:""},F=(o,t)=>({...t,name:t.name||o,description:t.description||o,toolbar:{...t.toolbar,items:t.toolbar.items.map(e=>{let r=typeof e=="string"?{value:e,title:e}:e;return r.type==="reset"&&t.toolbar.icon&&(r.icon=t.toolbar.icon,r.hideIcon=!0),{...Y,...r}})}});var K=()=>{let o=Z(),t=Object.keys(o).filter(e=>!!o[e].toolbar);return t.length?x.createElement(x.Fragment,null,x.createElement(ee,null),t.map(e=>{let r=F(e,o[e]);return x.createElement(V,{key:e,id:e,...r})})):null};W.register(b,()=>W.add(b,{title:b,type:oe.TOOL,match:()=>!0,render:()=>te.createElement(K,null)}));
