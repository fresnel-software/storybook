import{a as p}from"./chunk-JVA5Y325.mjs";import{logger as i}from"@storybook/node-logger";import n from"fs";import s from"path";import d from"@storybook/semver";import{logger as h}from"@storybook/node-logger";var l=n.realpathSync(process.cwd()),r;function u({noCache:e}={}){if(r&&!e)return r;let t=n.realpathSync(s.join(l,"/node_modules/.bin/react-scripts"));try{if(/node_modules[\\/]\.bin[\\/]react-scripts/i.test(t)){let c=n.readFileSync(t,"utf8").match(/"\$basedir[\\/]([^\s]+?[\\/]bin[\\/]react-scripts\.js")/i);c&&c.length>1&&(t=s.join(l,"/node_modules/.bin/",c[1]))}}catch(a){h.warn(`Error occurred during react-scripts package path resolving: ${a}`)}r=s.join(t,"../..");let o=s.join(r,"package.json");return n.existsSync(o)||(r="react-scripts"),r}function f(e="2.0.0"){try{let t=p(s.join(u(),"package.json"));return!d.gtr(e,t.version)}catch{return!1}}var b=e=>{e.some(o=>{let a=typeof o=="string"?o:o.name;return/@storybook(\/|\\)preset-create-react-app/.test(a)})||(i.warn("Storybook support for Create React App is now a separate preset."),i.warn("To use the new preset, install `@storybook/preset-create-react-app` and add it to the list of `addons` in your `.storybook/main.js` config file."),i.warn("The built-in preset has been disabled in Storybook 6.0."))},N=(e,{presetsList:t})=>(f()&&t&&b(t),e.module?.rules?.push({test:/\.m?js$/,type:"javascript/auto"},{test:/\.m?js$/,resolve:{fullySpecified:!1}}),e);export{N as webpackFinal};
